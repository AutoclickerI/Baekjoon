_,*l=[[*map(int,i.split())]for i in open(0)]
while l:[n,_],*l=l;*x,y=l[:n+1];print(sum(v*min(y[j-1]for j in z)for _,*z,v in x));l=l[n+1:]