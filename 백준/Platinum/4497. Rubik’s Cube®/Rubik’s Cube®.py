def rotate(b,r):
    z=r.lower()
    if z=='r':
        s=2,5,8,11,14,17,20,23,26,51,48,45,36,37,38,39,40,41,42,43,44
        e=11,14,17,20,23,26,51,48,45,2,5,8,42,39,36,43,40,37,44,41,38
    if z=='l':
        s=0,3,6,9,12,15,18,21,24,53,50,47,27,28,29,30,31,32,33,34,35
        e=53,50,47,0,3,6,9,12,15,18,21,24,33,30,27,34,31,28,35,32,29
    if z=='u':
        s=27,28,29,9,10,11,36,37,38,45,46,47,0,1,2,3,4,5,6,7,8
        e=9,10,11,36,37,38,45,46,47,27,28,29,6,3,0,7,4,1,8,5,2
    if z=='d':
        s=15,16,17,42,43,44,51,52,53,33,34,35,18,19,20,21,22,23,24,25,26
        e=33,34,35,15,16,17,42,43,44,51,52,53,24,21,18,25,22,19,26,23,20
    if z=='b':
        s=0,1,2,38,41,44,26,25,24,33,30,27,45,46,47,48,49,50,51,52,53
        e=38,41,44,26,25,24,33,30,27,0,1,2,51,48,45,52,49,46,53,50,47
    if z=='f':
        s=6,7,8,36,39,42,20,19,18,35,32,29,9,10,11,12,13,14,15,16,17
        e=35,32,29,6,7,8,36,39,42,20,19,18,15,12,9,16,13,10,17,14,11
    
    for _ in[0]*(1+(r!=z)*2):
        t=[b[i]for i in s]
        for i,c in zip(e,t):
            b[i]=c

def decode(b):
    W,O,R,B,G,Y=[[i[j*3:j*3+3]for i in b]for j in range(6)]
    s=sum(W,[])
    for i in zip(*R):
        s+=i[::-1]
    for i in zip(*[i[::-1]for i in Y]):
        s+=i
    for v in B,O,G:
        for i in zip(*v):
            s+=i[::-1]
    return s

def encode(b):
    s=[[],[],[]]
    W,R,Y,B,O,G=zip(*[iter([i for i in zip(*[iter(b)]*3)])]*3)
    for i in 0,1,2:
        s[i]+=W[i]
    for v in O,R,B,G:
        *t,=zip(*[i[::-1]for i in v])
        for i in 0,1,2:
            s[i]+=t[i]
    *t,=zip(*Y)
    for i in 0,1,2:
        s[i]+=t[i][::-1]
    return s


for _ in[0]*int(input()):
    b=[input().split()for _ in[0]*3]
    command=input()
    cube=decode(b)
    
    for i in command.translate(str.maketrans('WORBGY','URFLBD')):
        rotate(cube,i)
    
    for i in encode(cube):
        print(*i)
    print('='*35)