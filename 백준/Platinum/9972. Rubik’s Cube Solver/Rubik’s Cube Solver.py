def rotate(b,r):
    z=r.lower()
    if z=='r':
        s=2,5,8,11,14,17,20,23,26,51,48,45,36,37,38,39,40,41,42,43,44
        e=11,14,17,20,23,26,51,48,45,2,5,8,42,39,36,43,40,37,44,41,38
    if z=='l':
        s=0,3,6,9,12,15,18,21,24,53,50,47,27,28,29,30,31,32,33,34,35
        e=53,50,47,0,3,6,9,12,15,18,21,24,33,30,27,34,31,28,35,32,29
    if z=='u':
        s=27,28,29,9,10,11,36,37,38,45,46,47,0,1,2,3,4,5,6,7,8
        e=9,10,11,36,37,38,45,46,47,27,28,29,6,3,0,7,4,1,8,5,2
    if z=='d':
        s=15,16,17,42,43,44,51,52,53,33,34,35,18,19,20,21,22,23,24,25,26
        e=33,34,35,15,16,17,42,43,44,51,52,53,24,21,18,25,22,19,26,23,20
    if z=='b':
        s=0,1,2,38,41,44,26,25,24,33,30,27,45,46,47,48,49,50,51,52,53
        e=38,41,44,26,25,24,33,30,27,0,1,2,51,48,45,52,49,46,53,50,47
    if z=='f':
        s=6,7,8,36,39,42,20,19,18,35,32,29,9,10,11,12,13,14,15,16,17
        e=35,32,29,6,7,8,36,39,42,20,19,18,15,12,9,16,13,10,17,14,11
    
    for _ in[0]*(1+(r!=z)*2):
        t=[b[i]for i in s]
        for i,c in zip(e,t):
            b[i]=c

def decode(b):
    s=[*''.join(b[:3])]
    for i in range(3,6):
        s+=b[i][3:6]
    s+=''.join(b[6:])
    for v in 0,6,9:
        for i in range(3,6):
            s+=b[i][v:v+3]
    return s

while'U'>input()[-2]:
    b=[input().replace(' ','')for _ in[0]*9]
    cube=decode(b)
    while s:=input():
        if s[-1]<'a':break
        p,q=s.split()
        if p[1]=='o':
            p='ud'['tb'.find(p[0])]
        else:
            p=p[0]
        if'r'<q:
            p=p.upper()
        rotate(cube,p)
    print('YNeos'[any(1-len({*cube[i*9:i*9+9]})for i in range(6))::2])